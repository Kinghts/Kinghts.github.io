{"name":"某文档网站优化记录","keywords":"优化，UI，组件库","createAt":"2018-12-31","updateAt":"2018-12-31 10:21:59","brief":"<p>最近维护着一个组件库的文档网站，网站仅在内网访问，理论上速度应该很快，但是没经过优化前仍有一些性能上的问题，本文是对这些优化过程的记录</p>\n","content":"<!--keywords:优化，UI，组件库-->\n<!--create:2018-12-31-->\n<p>最近维护着一个组件库的文档网站，网站仅在内网访问，理论上速度应该很快，但是没经过优化前仍有一些性能上的问题，本文是对这些优化过程的记录。</p>\n<h3 id=\"-\">网站的结构</h3>\n<p>该网站使用vue开发、nginx作为静态服务器，无数据库依赖。</p>\n<p>网站的页面大概可以分为两种，首页和组件详情页。</p>\n<h3 id=\"-\">首页的优化</h3>\n<p>来一张图：\n<img src=\"img/main-without-cache.png\" alt=\"main-without-cache\"></p>\n<h4 id=\"nginx\">nginx</h4>\n<p>前端老司机看一眼可能就明白了主要的问题，nginx没开启gzip。\n赶紧ssh上去改配置：</p>\n<pre><code class=\"lang-json\">nginx.conf 文件：\n</code></pre>\n<pre><code class=\"lang-json\">http {\n\n    gzip on;\n        gzip_types    text/plain application/javascript application/x-javascript text/javascript text/xml text/css;\n\n}\n</code></pre>\n<p>执行：</p>\n<pre><code class=\"lang-json\">nginx -s reload\n</code></pre>\n<p>效果：\n<img src=\"img/main-with-gzip.png\" alt=\"gzip\"></p>\n<h4 id=\"-\">背景图</h4>\n<p>大家都说背景图非常好看，但是有600多KB大，gzip也没法压缩，那怎么办呢？\n试一下<a href=\"https://tinypng.com/\">tinypng</a>。</p>\n<p>效果：\n<img src=\"img/image-zip.png\" alt=\"image-zip\"></p>\n<p>压缩了一半，美滋滋。</p>\n<h4 id=\"-\">首页最终效果</h4>\n<p><img src=\"img/main-result.png\" alt=\"main-result\"></p>\n<h3 id=\"-\">组件详情页的优化</h3>\n<h4 id=\"cdn\">cdn</h4>\n<p>看图说话：\n<img src=\"img/icon-page-with-cdn.png\" alt=\"icon-page-with-cdn\"></p>\n<p>cloudflare CDN在国内也太慢了吧，那就去掉好了。</p>\n<p>效果：\n<img src=\"img/icon-page-without-cdn.png\" alt=\"icon-page-without-cdn\"></p>\n<h3 id=\"todo\">todo</h3>\n<h4 id=\"font-awesome\">font-awesome</h4>\n<p>由于某些奇怪的原因，该网站引入了font-awesome，全局搜索后发现使用的地方不多，遂拜托UI大姐姐将这些图标加到组件库里去。然后就可以移除font-awesome的引用了。</p>\n<h4 id=\"main-vendors-js\">main.*与vendors.*.js</h4>\n<p>该网站引入了两个UI组件库，需要花一些时间才能移除其中一个组件库，这样可以减小main.*与vendors.*.js的大小。</p>\n"}